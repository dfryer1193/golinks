<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go/Links</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;700&display=swap">
  </head>
  <body>
    <div class="container">
      <pre class="ascii-art">

 ██████╗  ██████╗     ██╗██╗     ██╗███╗   ██╗██╗  ██╗███████╗
██╔════╝ ██╔═══██╗   ██╔╝██║     ██║████╗  ██║██║ ██╔╝██╔════╝
██║  ███╗██║   ██║  ██╔╝ ██║     ██║██╔██╗ ██║█████╔╝ ███████╗
██║   ██║██║   ██║ ██╔╝  ██║     ██║██║╚██╗██║██╔═██╗ ╚════██║
╚██████╔╝╚██████╔╝██╔╝   ███████╗██║██║ ╚████║██║  ██╗███████║
 ╚═════╝  ╚═════╝ ╚═╝    ╚══════╝╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝╚══════╝

      </pre>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Path</th>
              <th>URL</th>
              <th class="action-column"/>
            </tr>
          </thead>
          <tbody id="redirectsTableBody">
            <!-- Table rows will be dynamically populated here -->
          </tbody>
        </table>
      </div>
    </div>

    <script>
      const redirectsTableBody = document.getElementById('redirectsTableBody');
      fetch('/redirects')
        .then(response => response.json())
        .then(data => {
          for (const path in data) {
            if (data.hasOwnProperty(path)) {
              const url = data[path];
              const tableRow = document.createElement('tr');
              tableRow.innerHTML = `
              <td>${path}</td>
              <td><a href="${url}" target="_blank">${url}</a></td>
              <td>
                <button class="delete-button" data-id="${path}">Delete</button>
                <button class="update-button" data-id="${path}">Update</button>
              </td>
            `;
              redirectsTableBody.appendChild(tableRow);
            }
          }
        })
        .catch(error => {
          console.error('Error fetching redirects:', error);
        });

      document.addEventListener('DOMContentLoaded', function() {
        redirectsTableBody.addEventListener('click', function(event) {
          if (event.target.classList.contains('delete-button')) {
            const id = event.target.getAttribute('data-id');
            fetch(`/${id}`, {
              method: 'DELETE',
            })
            .then(data => {
              alert('Shortcut deleted successfully');
              window.location.href = '/';
            })
            .catch(error => {
              console.error('Error deleting row:', error);
            });
          }

          if (event.target.classList.contains('update-button')) {
            const id = event.target.getAttribute('data-id');
            window.location.href = `/update?path=${id}`;
          }
        });
      });
    </script>
  </body>
</html>

